<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collectibles Game</title>
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-physics-system@4.0.1/dist/aframe-physics-system.min.js"></script>
</head>
<body>
    <a-scene physics="debug: true; gravity: -9.8;">
        <a-sky color="#FFE4B5"></a-sky>
        <a-plane position="0 0 -4" rotation="-90 0 0" width="50" height="50" color="#696969"></a-plane>

        <a-camera position="0 1.6 0">
            <a-cursor></a-cursor>
        </a-camera>

        <a-sphere position="0 1 -3" radius="0.5" color="#FF0000" class="collectible" collectible></a-sphere>
        <a-sphere position="1 1 -5" radius="0.5" color="#00FF00" class="collectible" collectible></a-sphere>
        <a-sphere position="-1 1 -6" radius="0.5" color="#0000FF" class="collectible" collectible></a-sphere>
        <a-sphere position="2 1 -10" radius="0.5" color="#0000FF" class="collectible" collectible></a-sphere>
        <a-sphere position="-4 1 -3" radius="0.5" color="#0000FF" class="collectible" collectible></a-sphere>
        <a-sphere position="6 1 5" radius="0.5" color="#0000FF" class="collectible" collectible></a-sphere>

        <a-text id="scoreText" value="Score: 0" position="-5 3 -5" color="#000000"></a-text>
        <a-text id="timerText" value="Time: 60" position="5 3 -5" color="#000000"></a-text>
        <a-text id="gameOverText" value="" position="0 2 -3" color="#FF0000" visible="false"></a-text>

        <a-assets>
            <a-asset-item id="myModel" src="rose.glb"></a-asset-item>
        </a-assets>

        <a-entity id="player" position="0 1.6 0" wasd-controls>
            <a-entity collider="objects: .collectible" position="0 1 0"></a-entity>
        </a-entity>
        <a-entity id="movingObj" geometry="primitive: cone" material="color: red" position="0 2 -8" animation="property: position; to: 7 2 -10; dur: 2000; loop: true"></a-entity>

        <a-entity gltf-model="#myModel" position="2 1 -5"></a-entity>
        <a-entity id="leftHand" hand-controls="hand: left; handModelStyle: lowPoly; color: #ffcccc"></a-entity>
        <a-entity id="rightHand" hand-controls="hand: right; handModelStyle: lowPoly; color: #ffcccc"></a-entity>
        <a-entity id="explosion" particle-system="preset: explosion; color: #FFFF00; particleCount: 500; size: 2; lifetime: 1.5;"></a-entity>
        <a-entity geometry="primitive: box" material="color: blue" position="0 1 -10" dynamic-body></a-entity>
        <a-sound src="zvook.wav" autoplay="false" id="collectSound"></a-sound>
    </a-scene>

    <script>
        let score = 0;
        let timer = 60;
        let timerInterval;
        let isGameOver = false;

        function updateScore() {
            document.querySelector('#scoreText').setAttribute('value', `Score: ${score}`);
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                if (isGameOver) return;
                timer--;
                document.querySelector('#timerText').setAttribute('value', `Time: ${timer}`);
                if (timer <= 0) {
                    endGame();
                }
            }, 1000);
        }

        function endGame() {
            isGameOver = true;
            clearInterval(timerInterval);
            const gameOverText = document.querySelector('#gameOverText');
            gameOverText.setAttribute('value', `Game Over! Your score: ${score}`);
            gameOverText.setAttribute('visible', 'true');
        }

        AFRAME.registerComponent('collectible', {
            init: function () {
                this.el.addEventListener('collide', () => {
                    if (isGameOver) return;
                    score++;
                    updateScore();
                    this.el.parentNode.removeChild(this.el);
                    document.querySelector('#collectSound').components.sound.playSound();
                });
            }
        });

        startTimer();

        document.addEventListener('click', () => {
            document.querySelector('#collectSound').components.sound.playSound();
        });
    </script>
</body>
</html>
